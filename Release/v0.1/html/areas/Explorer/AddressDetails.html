<div class="AddressDetails center" >
    <div class="panel panel-default">

        <div class="panel-heading address-address">
        </div>

        <div class="panel-body">
            <div class="row">
                <div class="col-xs-2">
                    <div>
                        Total Sent (CHC)
                    </div>
                    <div class="address-sent">

                    </div>
                </div>

                <div class="col-xs-2">
                    <div>
                        Total Received (CHC)
                    </div>
                    <div class="address-received">

                    </div>
                </div>
                <div class="col-xs-2">
                    <div>
                        Balance (CHC)
                    </div>
                    <div class="address-balance">

                    </div>
                </div>
                

            </div>

        </div>
    </div>


    <div class="panel panel-default TransactionList">

        <div class="panel-heading">Transactions
            <span class="block-transactions"></span>
        </div>

        <div class="panel-body">



            <div class="row header">

                <div class="col-lg-5 timestamp-col">
                    Timestamp
                </div>

                <div class="col-lg-5 hash-col">
                    hash
                </div>

                <div class="col-lg-2 amount-col">
                    Amount (CHC)
                </div>
            </div>

            <div class="rows">

            </div>

        </div>
    </div>
</div>

<script>
    $(function(){
        $(".AddressDetails").on("showArea", function (event, address) {
                loadBlock(address);
        });


        var addressDetailsEl = $(".AddressDetails");
        var addressEl = addressDetailsEl.find(".address-address");
        var sentEl = addressDetailsEl.find(".address-sent");
        var receivedEl = addressDetailsEl.find(".address-received");
        var balanceEl = addressDetailsEl.find(".address-balance");

        var transactionListEl = blockDetailsEl.find(".TransactionList");
        var transactionRowTemplateEl = transactionListEl.find(".header").removeClass("header");
        var transactionRowsEl = transactionListEl.find(".rows");

        var loadAddress = function (address) {
            getBlock(blockId).then(function (block) {
                blockHashEl.text(block.hash);
                blockHeightEl.text(block.height);
                blockDifficultyEl.text(block.difficulty);
                blockConfirmationsEl.text(block.confirmations);
                blockSizeEl.text((block.size/ 1024).toFixed(3));
                blockBitsEl.text(block.bits);
                blockNonceEl.text(block.nonce);


                var timestamp = new Date(block.time * 1000);
                blockTimestampEl.text(timestamp.toLocaleTimeString() + " " + timestamp.toLocaleDateString());

                transactionRowsEl.empty();
                for (var i = 0; i < block.transactions.length; i++) {

                    var transationRowEl = transactionRowTemplateEl.clone().appendTo(transactionRowsEl);

                    var anchorEl = $('<a href="#Explorer/Transaction/' + block.transactions[i].txid + '" />');

                    transationRowEl.find(".hash-col").text("");
                    var hashAnchorEl = anchorEl.clone().appendTo(transationRowEl.find(".hash-col"));
                    hashAnchorEl.text(block.transactions[i].txid);

                    var recipientCount = 0;
                    block.transactions[i].vout.forEach(function (vout) {
                        if (vout.value != 0) recipientCount++;
                    });
                    transationRowEl.find(".recipients-col").text(recipientCount);

                    var transactionValue = 0;
                    block.transactions[i].vout.forEach(function (vout) {
                        transactionValue = transactionValue + vout.value;
                    });
                    transationRowEl.find(".amount-col").text(transactionValue);
                }

            });
        }


    })
</script>