<div class="BlockDetails center" >
    <div class="panel panel-default">

        <div class="panel-heading">CHC Block:
            <span class="block-hash"></span>
        </div>

        <div class="panel-body">
            <div class="row">
                <div class="col-xs-2">
                    <div>
                        Height
                    </div>
                    <div class="block-height">

                    </div>
                </div>

                <div class="col-xs-2">
                    <div>
                        Difficulty
                    </div>
                    <div class="block-difficulty">

                    </div>
                </div>
                <div class="col-xs-2">
                    <div>
                        Confirmations
                    </div>
                    <div class="block-confirmations">

                    </div>
                </div>
                <div class="col-xs-2">
                    <div>
                        Size (kB)
                    </div>
                    <div class="block-size">

                    </div>
                </div>
                <div class="col-xs-2">
                    <div>
                        Bits
                    </div>
                    <div class="block-bits">

                    </div>
                </div>
                <div class="col-xs-2">
                    <div>
                        Nonce
                    </div>
                    <div class="block-nonce">

                    </div>
                </div>
                <div class="col-xs-2">
                    <div>
                        Timestamp
                    </div>
                    <div class="block-timestamp">

                    </div>
                </div>

            </div>

        </div>
    </div>


    <div class="panel panel-default TransactionList">

        <div class="panel-heading">Transactions
            <span class="block-transactions"></span>
        </div>

        <div class="panel-body">



            <div class="row header">

                <div class="col-lg-5 hash-col">
                    Hash
                </div>

                <div class="col-lg-1 recipients-col">
                    Recipients
                </div>

                <div class="col-lg-2 amount-col">
                    Amount (CHC)
                </div>
                <div class="col-lg-2 controls-col">
                    view
                </div>
            </div>

            <div class="rows">

            </div>

        </div>
    </div>
</div>
<script>
     //block details 
     $(function () {

            $(".BlockDetails").on("showArea", function (event, blockId) {
                loadBlock(blockId);
            });


            var blockDetailsEl = $(".BlockDetails");
            var blockHashEl = blockDetailsEl.find(".block-hash");
            var blockHeightEl = blockDetailsEl.find(".block-height");
            var blockDifficultyEl = blockDetailsEl.find(".block-difficulty");
            var blockConfirmationsEl = blockDetailsEl.find(".block-confirmations");
            var blockSizeEl = blockDetailsEl.find(".block-size");
            var blockBitsEl = blockDetailsEl.find(".block-bits");
            var blockNonceEl = blockDetailsEl.find(".block-nonce");
            var blockTimestampEl = blockDetailsEl.find(".block-timestamp");


            var transactionListEl = blockDetailsEl.find(".TransactionList");
            var transactionRowTemplateEl = transactionListEl.find(".header").removeClass("header");
            var transactionRowsEl = transactionListEl.find(".rows");

            var loadBlock = function (blockId) {
                getBlock(blockId).then(function (block) {
                    blockHashEl.text(block.hash);
                    blockHeightEl.text(block.height);
                    blockDifficultyEl.text(block.difficulty);
                    blockConfirmationsEl.text(block.confirmations);
                    blockSizeEl.text((block.size/ 1024).toFixed(3));
                    blockBitsEl.text(block.bits);
                    blockNonceEl.text(block.nonce);


                    var timestamp = new Date(block.time * 1000);
                    blockTimestampEl.text(timestamp.toLocaleTimeString() + " " + timestamp.toLocaleDateString());

                    transactionRowsEl.empty();
                    for (var i = 0; i < block.transactions.length; i++) {

                        var transationRowEl = transactionRowTemplateEl.clone().appendTo(transactionRowsEl);

                        var anchorEl = $('<a href="#Explorer/Transaction/' + block.transactions[i].txid + '" />');

                        transationRowEl.find(".hash-col").text("");
                        var hashAnchorEl = anchorEl.clone().appendTo(transationRowEl.find(".hash-col"));
                        hashAnchorEl.text(block.transactions[i].txid);

                        var recipientCount = 0;
                        block.transactions[i].vout.forEach(function (vout) {
                            if (vout.value != 0) recipientCount++;
                        });
                        transationRowEl.find(".recipients-col").text(recipientCount);

                        var transactionValue = 0;
                        block.transactions[i].vout.forEach(function (vout) {
                            transactionValue = transactionValue + vout.value;
                        });
                        transationRowEl.find(".amount-col").text(transactionValue);
                    }

                });
            }


        });
</script>